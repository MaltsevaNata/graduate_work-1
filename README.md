# UPDATE after review
- про права админки не совсем понятно. Логика такая: сейчас у нас
маленькая компания и мы людям доверяем -- кто-то что-то удалил, то он сам дурак. 
  В дальнейшем планируем добавить разграничение ролей в админке, на это заведена бага.
  
- про константы в тестах. Тут есть о чем поспорить, хотя генераторы данных вещь безусловно
хорошая. Но пока оставили так как есть.
  
- про моки в коде и патчи. Если успеем, то обязательно поправим, но пока без них.

- про зависимости сервисов. Архитектурный косяк нами осознан, решить его планируем
отдельным сервисом заказов. О том почему сейчас и так и как планируем исправить,
  расскажем уже на защите.
 
Всё остальное вроде бы поправили. Убедительная просьба писать ответ в гите, ревью борда
Практикума бессмысленна и неудобная чуть более чем полностью. 

# Биллинг и всякое
Ознакомиться со структурой проекта можно [тут](https://miro.com/app/board/o9J_lsATuns=/?invite_link_id=410429303384).
После запуска проекта, сервисы будут доступны тут: [админка](http://127.0.0.1:8002/admin/) с доступом admin/password,
[subscription api](http://127.0.0.1:8001/api/openapi#/) и [payments api](http://127.0.0.1:8000/api/openapi#/).

## Как это запустить
- ### поднять всё с батарейками:
```shell
make all
```

- ### инфраструктура для разработки:
```shell
make dev
```

- ### инициаилазция баз данных и запуск миграций:
```shell
make init_db
```

- ### запуск тестов:
```shell
make test
```

Создается новый контейнер постгри, инициализируются базы и миграции, после запуска тестов
удаляются все контейнеры

- ### локальный запуск user subscription api
После поднятия инфраструктуры, нужно задать путь к приложению
и выполнить миграции.

Можно воспользоваться скриптом:
```shell
cd ./subscription_api
./prestart.sh
```
Либо выполнить руками:
```shell
cd ./subscription_api
export PYTHONPATH=$(readlink -f ./)
alembic upgrade head
```
# FAQ
1. **О авторизации**.
Сейчас для простоты используем HS256 и храним секретный ключ в приложении. 
   Заготовка для работы с RS256 и получением публичного ключа от сервиса
   авторизации есть, но постоянно держать запущенным сервис авторизации неудобно.
   
2. **О snake style в апишке**. Досадный недочёт, бага на исправление заведена.
3. **O TODO и FIXME в коде**. Очень спешили отправить на ревью,
   не всё получилось сделать красиво.
   